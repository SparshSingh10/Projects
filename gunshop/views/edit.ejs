<% layout('layouts/boilerplate') %>
<%- include('./partials/navbar') %>

<div class="container p-lg-5 mt-5 w-50">
    <%-include('./partials/flash')%>
    <form action="/guns/<%= foundGun.id %>?_method=PATCH" method="POST" class="needs-validation" novalidate>
            <input type="hidden" name="_method" value="PATCH">
            <div class="mb-3">
                <label for="gunName" class="form-label">Gun Name: </label>
                <input type="text" class="form-control" name="name" id="gunName" placeholder="Name of Gun" value="<%= foundGun.name %>" required>
                <div class="valid-feedback">
                    Looks good!
                </div>
                <div class="invalid-feedback">
                    Please enter a valid gun name.
                </div>
            </div>
            <div class="mb-3">
                <label for="gunImage" class="form-label">Gun Image URL: </label>
                <input type="text" class="form-control" name="img" id="gunImage" placeholder="Image URL of Gun" value="<%= foundGun.img %>" required>
                <div class="valid-feedback">
                    Looks good!
                </div>
                <div class="invalid-feedback">
                    Image URL is mandatory.
                </div>
            </div>
            <div class="mb-3">
                <label for="gunPrice" class="form-label">Gun Price: </label>
                <div class="input-group mb-3">
                    <span class="input-group-text" id="basic-addon1">Rs. </span>
                    <input class="form-control" type="number" name="price" id="gunPrice" placeholder="Price of Gun" value="<%= foundGun.price %>" required>
                    <div class="valid-feedback">
                        Looks good!
                    </div>
                    <div class="invalid-feedback">
                        Please enter a valid price (at least 1 rupee).
                    </div>
                </div>
            </div>
            <div class="mb-3">
                <label for="gunType" class="form-label">Gun Type: </label>
                <input type="text" class="form-control" name="type" id="gunType" placeholder="Type of Gun" value="<%= foundGun.type %>">
                <!-- No validation for optional field -->
            </div>
            <div class="mb-3">
                <label for="isLegal" class="form-label">Is Legal? </label>
                <select class="form-control" name="isLegal" id="isLegal" required>
                    <option value="true" <%= foundGun.isLegal ? 'selected' : '' %>>Yes</option>
                    <option value="false" <%= !foundGun.isLegal ? 'selected' : '' %>>No</option>
                </select>
                <div class="valid-feedback">
                    Looks good!
                </div>
                <div class="invalid-feedback">
                    Please select whether the gun is legal or not.
                </div>
            </div>
            <button type="submit" class="btn btn-sm btn-success">Update Gun</button>
        </form>
    </div>
    

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
    (() => {
        'use strict'
        
        const forms = document.querySelectorAll('.needs-validation')

        Array.from(forms).forEach(form => {
            form.addEventListener('submit', event => {
                if (!form.checkValidity()) {
                    event.preventDefault()
                    event.stopPropagation()
                }

                form.classList.add('was-validated')
            }, false)
        })
    })()
</script>
</body>
</html>
